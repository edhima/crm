import{a as Ie,u as be,b as Me,V as pe,c as Ae}from"./VSelect.b74e084b.js";import{p as se,x as R,e as p,u as $,U as Pe,W as q,X as _e,h as De,Y as Ke,Z as Le,i as Re,$ as Te,a0 as E,j as G,a1 as Oe,a2 as Ee,a3 as je,D as J,E as ue,a4 as Ue,n as Be,y as ne,v as i,F as H,a5 as Ne,w as z,a6 as $e,a7 as oe,V as ce,a8 as ze,K as He,a9 as We,aa as Qe,ab as re}from"./index.b477d4b7.js";const Xe=(e,s,l)=>e==null||s==null?-1:e.toString().toLocaleLowerCase().indexOf(s.toString().toLocaleLowerCase()),Ye=se({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function Ze(e,s,l){var C,F,A;const k=[],h=(C=l==null?void 0:l.default)!=null?C:Xe,y=l!=null&&l.filterKeys?q(l.filterKeys):!1,V=Object.keys((F=l==null?void 0:l.customKeyFilter)!=null?F:{}).length;if(!(e!=null&&e.length))return k;e:for(let x=0;x<e.length;x++){const[o,u=o]=q(e[x]),b={},S={};let g=-1;if(s&&!(l!=null&&l.noFilter)){if(typeof o=="object"){const W=y||Object.keys(u);for(const K of W){const v=_e(u,K,u),n=(A=l==null?void 0:l.customKeyFilter)==null?void 0:A[K];if(g=n?n(v,s,o):h(v,s,o),g!==-1&&g!==!1)n?b[K]=g:S[K]=g;else if((l==null?void 0:l.filterMode)==="every")continue e}}else g=h(o,s,o),g!==-1&&g!==!1&&(S.title=g);const P=Object.keys(S).length,M=Object.keys(b).length;if(!P&&!M||(l==null?void 0:l.filterMode)==="union"&&M!==V&&!P||(l==null?void 0:l.filterMode)==="intersection"&&(M!==V||!P))continue}k.push({index:x,matches:{...S,...b}})}return k}function Ge(e,s,l,k){const h=R([]),y=R(new Map),V=p(()=>k!=null&&k.transform?$(s).map(F=>[F,k.transform(F)]):$(s));Pe(()=>{const F=typeof l=="function"?l():$(l),A=typeof F!="string"&&typeof F!="number"?"":String(F),x=Ze(V.value,A,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),o=$(s),u=[],b=new Map;x.forEach(S=>{let{index:g,matches:P}=S;const M=o[g];u.push(M),b.set(M.value,P)}),h.value=u,y.value=b});function C(F){return y.value.get(F.value)}return{filteredItems:h,filteredMatches:y,getMatches:C}}function Je(e,s,l){if(s==null)return e;if(Array.isArray(s))throw new Error("Multiple matches is not implemented");return typeof s=="number"&&~s?i(H,null,[i("span",{class:"v-autocomplete__unmask"},[e.substr(0,s)]),i("span",{class:"v-autocomplete__mask"},[e.substr(s,l)]),i("span",{class:"v-autocomplete__unmask"},[e.substr(s+l)])]):e}const qe=se({autoSelectFirst:{type:[Boolean,String]},search:String,...Ye({filterKeys:["title"]}),...Ie(),...De(Ke({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Le({transition:!1})},"VAutocomplete"),tl=Re()({name:"VAutocomplete",props:qe(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,s){let{slots:l}=s;const{t:k}=Te(),h=R(),y=E(!1),V=E(!0),C=E(!1),F=R(),A=R(),x=G(e,"menu"),o=p({get:()=>x.value,set:t=>{var a;x.value&&!t&&((a=F.value)==null?void 0:a.\u03A8openChildren)||(x.value=t)}}),u=E(-1),b=p(()=>{var t;return(t=h.value)==null?void 0:t.color}),S=p(()=>o.value?e.closeText:e.openText),{items:g,transformIn:P,transformOut:M}=Oe(e),{textColorClasses:W,textColorStyles:K}=Ee(b),v=G(e,"search",""),n=G(e,"modelValue",[],t=>P(t===null?[null]:q(t)),t=>{var c;const a=M(t);return e.multiple?a:(c=a[0])!=null?c:null}),L=je(),{filteredItems:Q,getMatches:ie}=Ge(e,g,()=>V.value?"":v.value),I=p(()=>e.hideSelected?Q.value.filter(t=>!n.value.some(a=>a.value===t.value)):Q.value),ve=p(()=>n.value.map(t=>t.props.value)),j=p(()=>{var a;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&v.value===((a=I.value[0])==null?void 0:a.title))&&I.value.length>0&&!V.value&&!C.value}),X=p(()=>e.hideNoData&&!g.value.length||e.readonly||(L==null?void 0:L.isReadonly.value)),Y=R(),{onListScroll:fe,onListKeydown:de}=be(Y,h);function me(t){e.openOnClear&&(o.value=!0),v.value=""}function he(){X.value||(o.value=!0)}function ge(t){X.value||(y.value&&(t.preventDefault(),t.stopPropagation()),o.value=!o.value)}function ye(t){var D,r,f;if(e.readonly||(L==null?void 0:L.isReadonly.value))return;const a=h.value.selectionStart,c=n.value.length;if((u.value>-1||["Enter","ArrowDown","ArrowUp"].includes(t.key))&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(o.value=!0),["Escape"].includes(t.key)&&(o.value=!1),j.value&&["Enter","Tab"].includes(t.key)&&_(I.value[0]),t.key==="ArrowDown"&&j.value&&((D=Y.value)==null||D.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(t.key)){if(u.value<0){t.key==="Backspace"&&!v.value&&(u.value=c-1);return}const d=u.value,w=n.value[u.value];w&&_(w),u.value=d>=c-1?c-2:d}if(t.key==="ArrowLeft"){if(u.value<0&&a>0)return;const d=u.value>-1?u.value-1:c-1;n.value[d]?u.value=d:(u.value=-1,h.value.setSelectionRange((r=v.value)==null?void 0:r.length,(f=v.value)==null?void 0:f.length))}if(t.key==="ArrowRight"){if(u.value<0)return;const d=u.value+1;n.value[d]?u.value=d:(u.value=-1,h.value.setSelectionRange(0,0))}}}function Fe(t){v.value=t.target.value}function Ve(t){if(re(h.value,":autofill")||re(h.value,":-webkit-autofill")){const a=g.value.find(c=>c.title===t.target.value);a&&_(a)}}function ke(){var t;y.value&&(V.value=!0,(t=h.value)==null||t.focus())}function we(t){y.value=!0,setTimeout(()=>{C.value=!0})}function xe(t){C.value=!1}function Ce(t){(t==null||t===""&&!e.multiple)&&(n.value=[])}const T=E(!1);function _(t){if(e.multiple){const a=n.value.findIndex(c=>e.valueComparator(c.value,t.value));if(a===-1)n.value=[...n.value,t];else{const c=[...n.value];c.splice(a,1),n.value=c}}else n.value=[t],T.value=!0,v.value=t.title,o.value=!1,V.value=!0,ue(()=>T.value=!1)}return J(y,(t,a)=>{var c,D;t!==a&&(t?(T.value=!0,v.value=e.multiple?"":String((D=(c=n.value.at(-1))==null?void 0:c.props.title)!=null?D:""),V.value=!0,ue(()=>T.value=!1)):(!e.multiple&&!v.value?n.value=[]:j.value&&!C.value&&!n.value.some(r=>{let{value:f}=r;return f===I.value[0].value})&&_(I.value[0]),o.value=!1,v.value="",u.value=-1))}),J(v,t=>{!y.value||T.value||(t&&(o.value=!0),V.value=!t)}),J(o,()=>{if(!e.hideSelected&&o.value&&n.value.length){const t=I.value.findIndex(a=>n.value.some(c=>a.value===c.value));Ue&&window.requestAnimationFrame(()=>{var a;t>=0&&((a=A.value)==null||a.scrollToIndex(t))})}}),Be(()=>{const t=!!(e.chips||l.chip),a=!!(!e.hideNoData||I.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),c=n.value.length>0,[D]=ne.filterProps(e);return i(ne,z({ref:h},D,{modelValue:v.value,"onUpdate:modelValue":Ce,focused:y.value,"onUpdate:focused":r=>y.value=r,validationValue:n.externalValue,dirty:c,onInput:Fe,onChange:Ve,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":o.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!l.selection,"v-autocomplete--selecting-index":u.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:c?void 0:e.placeholder,"onClick:clear":me,"onMousedown:control":he,onKeydown:ye}),{...l,default:()=>i(H,null,[i(Ne,z({ref:F,modelValue:o.value,"onUpdate:modelValue":r=>o.value=r,activator:"parent",contentClass:"v-autocomplete__content",disabled:X.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ke},e.menuProps),{default:()=>{var r;return[a&&i($e,{ref:Y,selected:ve.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:f=>f.preventDefault(),onKeydown:de,onFocusin:we,onFocusout:xe,onScrollPassive:fe,tabindex:"-1",color:(r=e.itemColor)!=null?r:e.color},{default:()=>{var f,d,w,O;return[(f=l["prepend-item"])==null?void 0:f.call(l),!I.value.length&&!e.hideNoData&&((w=(d=l["no-data"])==null?void 0:d.call(l))!=null?w:i(oe,{title:k(e.noDataText)},null)),i(Me,{ref:A,renderless:!0,items:I.value},{default:U=>{var le,te;let{item:m,index:Z,itemRef:Se}=U;const ee=z(m.props,{ref:Se,key:Z,active:j.value&&Z===0?!0:void 0,onClick:()=>_(m)});return(te=(le=l.item)==null?void 0:le.call(l,{item:m,index:Z,props:ee}))!=null?te:i(oe,ee,{prepend:B=>{let{isSelected:N}=B;return i(H,null,[e.multiple&&!e.hideSelected?i(pe,{key:m.value,modelValue:N,ripple:!1,tabindex:"-1"},null):void 0,m.props.prependIcon&&i(ce,{icon:m.props.prependIcon},null)])},title:()=>{var B,N,ae;return V.value?m.title:Je(m.title,(B=ie(m))==null?void 0:B.title,(ae=(N=v.value)==null?void 0:N.length)!=null?ae:0)}})}}),(O=l["append-item"])==null?void 0:O.call(l)]}})]}}),n.value.map((r,f)=>{var O,U;function d(m){m.stopPropagation(),m.preventDefault(),_(r)}const w={"onClick:close":d,onMousedown(m){m.preventDefault(),m.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return i("div",{key:r.value,class:["v-autocomplete__selection",f===u.value&&["v-autocomplete__selection--selected",W.value]],style:f===u.value?K.value:{}},[t?l.chip?i(ze,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:r.title}}},{default:()=>{var m;return[(m=l.chip)==null?void 0:m.call(l,{item:r,index:f,props:w})]}}):i(Ae,z({key:"chip",closable:e.closableChips,size:"small",text:r.title},w),null):(U=(O=l.selection)==null?void 0:O.call(l,{item:r,index:f}))!=null?U:i("span",{class:"v-autocomplete__selection-text"},[r.title,e.multiple&&f<n.value.length-1&&i("span",{class:"v-autocomplete__selection-comma"},[He(",")])])])})]),"append-inner":function(){var w;for(var r=arguments.length,f=new Array(r),d=0;d<r;d++)f[d]=arguments[d];return i(H,null,[(w=l["append-inner"])==null?void 0:w.call(l,...f),e.menuIcon?i(ce,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:ge,onClick:We,"aria-label":k(S.value),title:k(S.value)},null):void 0])}})}),Qe({isFocused:y,isPristine:V,menu:o,search:v,filteredItems:Q,select:_},h)}});export{tl as V,Ye as m,Ge as u};
